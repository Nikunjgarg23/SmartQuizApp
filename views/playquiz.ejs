<!DOCTYPE html>
<html>

<head>
    <title >Quiz Timer</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>

<body>
    <div id="timer" style="text-align:right;">Time Remaining: 15:00</div>
    <h3 style="text-align: center;"> <%= quizname %></h3>
    <form action = "/student/saveanswer" method="post">
        <% for(let i of past_quiz){ %>
            <div class="container">
                <div class="row">
                    <div class="my-2">
                        <div class="card text-bg-secondary mb-3" style="border-color: black; border-width: 2px;">
                            <h7 class="card-body">
                                Qn 
                                <%= i.questionId%> : 
                                <%= i.questionText %>
                            </h7>
                            <div class="card-body">
                                <textarea name="answer" id="" cols="120" rows="2" placeholder="Answer"></textarea>
                             </div>
                            </div>
                        </div>
                    </div>
                </div>
                <% } %>      
                <div class="container" style="display: flex ; text-align: center;">
                    <button id="submitBtn" style="text-align: center;">Submit Quiz</button>
                </div> 
    </form>

    <script>
        // Set the timer duration in seconds
        const quizDuration = 9; // 15 minutes
        let remainingTime = quizDuration;
        let isTimeUp = false;

        const timerElement = document.getElementById("timer");
        const submitButton = document.getElementById("submitBtn");

        // Function to update the timer display
        function updateTimerDisplay() {
            const minutes = Math.floor(remainingTime / 60);
            const seconds = remainingTime % 60;
            timerElement.textContent = `Time Remaining: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        }

        // Function to handle the timer
        function startTimer() {
            const timerInterval = setInterval(function () {
                if (remainingTime > 0) {
                    remainingTime--;
                    updateTimerDisplay();
                } else {
                    isTimeUp = true;
                    updateTimerDisplay();
                    clearInterval(timerInterval);

                    // Automatically submit the quiz
                    submitButton.disabled = false;
                    submitButton.textContent = "Submit Quiz";
                }
            }, 1000); // 1 second interval
        }

        // Start the timer when the page loads
        startTimer();

        // Event listener for the submit button
        submitButton.addEventListener("click", function () {
            if (isTimeUp) {
                // Handle quiz submission here
                alert("Quiz submitted!");
            } else {
                alert("Quiz cannot be submitted before time is up.");
            }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
</body>

</html>